# Hacking Methodologies and Frameworks

Learning the hacking methodologies and frameworks helps ethical hackers understand the phases involved in hacking attempts along with the tactics, techniques, and procedures used by real hackers. This knowledge further helps them in strengthening the security infrastructure of their organization. This section discusses various hacking methodologies and frameworks such as the CEH ethical hacking framework, cyber kill chain methodology, MITRE ATT&CK framework, and Diamond Model of Intrusion Analysis.

---

## CEH Ethical Hacking Framework

EC-Council’s CEH ethical hacking framework defines the step-by-step process to perform ethical hacking. The CEH ethical hacking framework follows the same process as that of an attacker, and the only differences are in its hacking goals and strategies. This methodology helps security professionals and ethical hackers understand the various phases followed by real hackers in order to achieve their objectives. An understanding of the CEH ethical hacking framework helps ethical hackers learn various tactics, techniques, and tools used by attackers at various phases of hacking, which further guides them to succeed in the ethical hacking process.

According to the CEH ethical hacking framework, the following are the various phases involved in hacking.

### Phase 1: Reconnaissance

Footprinting and reconnaissance constitute the preparatory phase, in which an attacker gathers as much information as possible about the target prior to launching an attack. In this phase, the attacker creates a profile of the target organization and obtains information such as its IP address range, namespace, and employees.

Footprinting facilitates system hacking by revealing vulnerabilities. For example, the organization's website may provide employee biographies or a personnel directory, which the hacker can use for social engineering. Conducting a Whois query on the web can provide information about the networks and domain names associated with a specific organization. The footprinting target range may include the target organization's clients, employees, operations, network, and systems.

Reconnaissance techniques are broadly categorized into **active** and **passive**.
* When an attacker is using **passive reconnaissance** techniques, they do not interact with the target directly. Instead, the attacker relies on publicly available information, news releases, or other no-contact methods.
* **Active reconnaissance** techniques, on the other hand, involve direct interactions with the target system by using tools to detect open ports, accessible hosts, router locations, network mapping, details of operating systems, and applications.

**Scanning**
Scanning is used to identify active hosts, open ports, and unnecessary services enabled on particular hosts. In this phase, the attacker uses the details gathered during reconnaissance to scan the network for specific information. Scanning is a logical extension of active reconnaissance; in fact, some experts do not differentiate scanning from active reconnaissance. However, there is a slight difference in that scanning involves more in-depth probing by the attacker. Often, the reconnaissance and scanning phases overlap, and it is not always possible to separate them.

**Enumeration**
Enumeration involves making active connections to a target system or subjecting it to direct queries. It is a method of intrusive probing through which attackers gather information such as network user lists, routing tables, security flaws, shared users, groups, applications, and banners.

### Phase 2: Vulnerability Scanning

Vulnerability assessment is the examination of the ability of a system or application, including its current security procedures and controls, to withstand assault. It recognizes, measures, and classifies security vulnerabilities in computer systems, networks, and communication channels. Attackers perform vulnerability analysis to identify security loopholes in the target organization's network, communication infrastructure, and end systems. The identified vulnerabilities are used by attackers to perform further exploitation of the target network.

### Phase 3: Gaining Access

This is the phase in which actual hacking occurs. The previous phases help attackers identify security loopholes and vulnerabilities in the target organizational IT assets. Attackers use this information, along with techniques such as password cracking and the exploitation of vulnerabilities including buffer overflows, to gain access to the target organizational system.

Gaining access refers to the point at which the attacker obtains access to the operating system (OS) or applications on a computer or network. A hacker's chances of gaining access to a target system depend on several factors, such as the architecture and configuration of the target system, the perpetrator's skill level, and the initial level of access obtained. Once an attacker gains access to the target system, they attempt to escalate privileges to obtain complete control. In this process, they also compromise the intermediate systems connected to it.

**Escalating Privileges**
After gaining access to a system using a low-privilege user account, the attacker may attempt to increase their privileges to the administrator level to perform protected system operations so that they can proceed to the next level of the system hacking phase, which is the execution of applications. The attacker exploits known system vulnerabilities to escalate user privileges.

### Phase 4: Maintaining Access

Maintaining access refers to the phase in which an attacker attempts to retain ownership of the system. Once an attacker gains access to the target system with admin- or root-level privileges (thus owning the system), they can use both the system and its resources at will. The attacker can either use the system as a launchpad to scan and exploit other systems or maintain a low profile and continue exploitation. Both of these actions can cause significant damage.

Attackers can upload, download, or manipulate data, applications, and configurations on the owned system and also use malicious software to transfer usernames, passwords, and any other information stored in the system. They can maintain control over the system for a long time by closing vulnerabilities to prevent other hackers from exploiting them. Occasionally, in the process, the attacker may provide some degree of protection to the system from other attacks. Attackers use compromised systems to launch further attacks.

### Phase 5: Clearing Tracks

To remain undetected, it is important for attackers to erase all the evidence of security compromise from the system. To achieve this, they might modify or delete logs in the system using certain log-wiping utilities, thus removing all evidence of their presence.

---

## Cyber Kill Chain Methodology

The cyber kill chain methodology is a component of intelligence-driven defense for the identification and prevention of malicious intrusion activities. This methodology helps security professionals in identifying the steps that adversaries follow in order to accomplish their goals. The cyber kill chain is a framework developed for securing cyberspace based on the concept of military kill chains. This method aims to actively enhance intrusion detection and response.

The cyber kill chain is equipped with a seven-phase protection mechanism to mitigate and reduce cyber threats. According to Lockheed Martin, cyberattacks might occur in seven different phases, from reconnaissance to the final accomplishment of the objective. An understanding of cyber kill chain methodology helps security professionals to leverage security controls at different stages of an attack and helps them to prevent the attack before it succeeds. It also provides greater insight into the attack phases, which helps in understanding the adversary's TTPs beforehand.

The various phases included in the cyber kill chain methodology are:

1.  **Reconnaissance**: An adversary performs reconnaissance to collect as much information about the target as possible to probe for weak points before actually attacking. They look for information such as publicly available information on the Internet, network information, system information, and the organizational information of the target.
2.  **Weaponization**: The adversary analyzes the data collected in the previous stage to identify the vulnerabilities and techniques that can exploit and gain unauthorized access to the target organization. Based on the vulnerabilities identified, the adversary selects or creates a tailored deliverable malicious payload (remote-access malware weapon) using an exploit and a backdoor to send to the victim.
3.  **Delivery**: The payload is transmitted to the intended victim(s) as an email attachment, via a malicious link on websites, or through a vulnerable web application or USB drive. Delivery is a key stage that measures the effectiveness of the defense strategies implemented by the target organization.
4.  **Exploitation**: After the weapon is transmitted to the intended victim, exploitation triggers the adversary's malicious code to exploit a vulnerability in the operating system, application, or server on a target system.
5.  **Installation**: The adversary downloads and installs more malicious software on the target system to maintain access to the target network for an extended period. They may use the weapon to install a backdoor to gain remote access.
6.  **Command and Control (C2)**: The adversary creates a command and control channel, which establishes two-way communication between the victim's system and an adversary-controlled server to communicate and pass data back and forth. The adversaries implement techniques such as encryption to hide the presence of such channels.
7.  **Actions on Objectives**: The adversary controls the victim's system from a remote location and finally accomplishes their intended goals. The adversary gains access to confidential data, disrupts the services or network, or destroys the operational capability of the target.

---

## Tactics, Techniques, and Procedures (TTPs)

Organizations should understand TTPs to protect their network against threat actors and upcoming attacks. TTPs enable organizations to stop attacks at the initial stage, thereby protecting the network against massive damages.

### Tactics

Tactics describe the way the threat actor operates during different phases of an attack. It consists of the various tactics used to gather information for the initial exploitation, perform privilege escalation and lateral movement, and deploy measures for persistence access to the system. An organization can profile threat actors based on the tactics they use.

### Techniques

To launch an attack successfully, threat actors use several techniques during its execution. These techniques include initial exploitation, setting up and maintaining command and control channels, accessing the target infrastructure, and covering the tracks of data exfiltration. Understanding the techniques used in the different phases of an attack is essential to analyzing the threat groups effectively.

### Procedures

“Procedures” involve a sequence of actions performed by the threat actors to execute different steps of an attack life cycle. The number of actions usually differs depending upon the objectives of the procedure and the APT group. An understanding and proper analysis of the procedures followed by certain threat actors during an attack helps organizations profile them.

---

## Adversary Behavioral Identification

Adversary behavioral identification involves the identification of the common methods or techniques followed by an adversary to launch attacks to penetrate an organization's network. It gives security professionals insight into upcoming threats and exploits. Some behaviors of an adversary that can be used to enhance detection capabilities include:

* **Internal Reconnaissance**: Enumeration of systems, hosts, and processes, and execution of various commands to find information such as local user context, system configuration, hostname, and IP addresses.
* **Use of PowerShell**: Automating data exfiltration and launching further attacks.
* **Unspecified Proxy Activities**: Creating and configuring multiple domains pointing to the same host to switch quickly between them to avoid detection.
* **Use of Command-Line Interface**: Interacting with the target system to browse files, modify content, create accounts, and download malicious code.
* **HTTP User Agent**: Modifying the content of the HTTP user agent field to communicate with the compromised system.
* **Command and Control Server**: Using C2 servers to communicate remotely with compromised systems through an encrypted session.
* **Use of DNS Tunneling**: Obfuscating malicious traffic in legitimate traffic carried by common protocols.
* **Use of Web Shell**: Creating a shell within a website to gain remote access to server functionalities.
* **Data Staging**: Collecting and combining as much data as possible after successful penetration.

---

## Indicators of Compromise (IoCs)

Indicators of Compromise are the clues, artifacts, and pieces of forensic data that are found on a network or operating system that indicate a potential intrusion or malicious activity. IoCs act as a good source of information about threats that serve as data points in the intelligence process. An IoC can be an atomic indicator, a computed indicator, or a behavioral indicator.

### Categories of Indicators of Compromise

* **Email Indicators**: The sender's email address, email subject, and attachments or links.
* **Network Indicators**: URLs, domain names, and IP addresses.
* **Host-Based Indicators**: Filenames, file hashes, registry keys, DLLs, and mutex.
* **Behavioral Indicators**: Specific behavior related to malicious activities, such as a document executing a PowerShell script.

### Key Indicators of Compromise

* Unusual outbound network traffic
* Unusual activity through a privileged user account
* Geographical anomalies
* Multiple login failures
* Increased database read volume
* Suspicious registry or system file changes
* Unusual DNS requests
* Web traffic with superhuman behavior

---

## MITRE ATT&CK Framework

MITRE ATT&CK is a globally accessible knowledge base of adversary tactics and techniques based on real-world observations. The ATT&CK knowledge base is used as a foundation for the development of specific threat models and methodologies. MITRE ATT&CK comprises three collections: Enterprise, Mobile, and PRE-ATT&CK.

ATT&CK for Enterprise contains 14 categories of tactics, which are derived from the later stages (exploit, control, maintain, and execute) of the seven-stage Cyber Kill Chain.

### Tactics in ATT&CK for Enterprise

* Reconnaissance
* Resource Development
* Initial Access
* Execution
* Persistence
* Privilege Escalation
* Defense Evasion
* Credential Access
* Discovery
* Lateral Movement
* Collection
* Command and Control
* Exfiltration
* Impact

---

## Diamond Model of Intrusion Analysis

The Diamond Model, developed by expert analysts, introduces state-of-the-art technology for intrusion analysis. This model offers a framework for recognizing clusters of correlated events. The model determines the vital atomic element that occurs in any intrusion activity, referred to as the Diamond event. The Diamond event consists of four basic features: adversary, capability, infrastructure, and victim.

### Essential Features of the Diamond Model

* **Adversary**: An opponent or hacker responsible for the attack event. The adversary takes advantage of a capability against the victim.
* **Victim**: The target that has been exploited or the environment where the attack was performed.
* **Capability**: All the strategies, methods, and procedures associated with an attack. It can also be a malware or tool used by an adversary.
* **Infrastructure**: The hardware or software used by the adversary to reach the victim.

### Additional Event Meta-Features

* **Timestamp**: The time and date of an event.
* **Phase**: The progress of an attack (e.g., reconnaissance, weaponization).
* **Result**: The outcome of an event (e.g., success, failure, CIA Compromised).
* **Direction**: The direction of the attack (e.g., adversary to infrastructure).
* **Methodology**: The general technique used (e.g., spear-phishing, DDoS).
* **Resource**: External resources like tools or technology used in the attack.

### Extended Diamond Model

The extended Diamond Model also includes:
* **Socio-political meta-feature**: Describes the relationship between the adversary and victim to determine the goal or motivation (e.g., financial benefit, espionage, hacktivism).
* **Technology meta-feature**: Describes the relationship between the infrastructure and capability and how technology enables both.
